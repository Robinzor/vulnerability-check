function Get-CVSS() {
    param(
        [Parameter()]
        [string]$Query
    )
    Start-Sleep -s 6
    $url = "https://services.nvd.nist.gov/rest/json/cves/2.0?cveId="
    $request = (invoke-webrequest $url$Query | ConvertFrom-Json)
    function ExtractCvssDetails($metrics) {
        $details = New-Object psobject -Property @{
            Base     = $metrics.cvssData.baseScore
            Exploit  = $metrics.exploitabilityScore
            Impact   = $metrics.impactScore
            Maturity = $metrics.exploitCodeMaturity
        }
        return $details
    }
    if ($null -ne $request.vulnerabilities.cve.metrics.cvssMetricV31) {
        $cvssDetails = ExtractCvssDetails $request.vulnerabilities.cve.metrics.cvssMetricV31[0]
    } elseif ($null -ne $request.vulnerabilities.cve.metrics.cvssMetricV30) {
        $cvssDetails = ExtractCvssDetails $request.vulnerabilities.cve.metrics.cvssMetricV30[0]
    } elseif ($null -ne $request.vulnerabilities.cve.metrics.cvssMetricV2) {
        $cvssDetails = ExtractCvssDetails $request.vulnerabilities.cve.metrics.cvssMetricV2[0]
    } else {
        Write-Error "No CVSS metrics found in the response"
        return
    }
    $Output = "$Query Base:$($cvssDetails.Base) Exploit:$($cvssDetails.Exploit) Impact:$($cvssDetails.Impact)"
    if ($null -ne $ExploitState){$Output += $ExploitState}
    return $Output
}

# Example call
Get-CVSS "CVE-2021-44228"
